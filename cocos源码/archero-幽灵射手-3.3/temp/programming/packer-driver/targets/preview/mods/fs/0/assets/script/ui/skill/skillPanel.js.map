{"version":3,"sources":["file:///Users/ykq/Downloads/archero/assets/script/ui/skill/skillPanel.ts"],"names":["_decorator","Component","Node","SpriteComponent","LabelComponent","localConfig","GameManager","SkillItem","util","uiManager","constant","playerData","SdkUtil","AudioManager","ccclass","property","SkillPanel","start","show","callback","_callback","lbGold","string","_gold","updatePayIcon","SHARE_ID","SKILL_REFRESH","spRefreshIcon","arrLock","instance","getLockPlyerSkill","shuffle","ndSkills","children","forEach","ndChild","idx","arr","info","queryByID","ID","active","scriptItem","getComponent","init","_close","onBtnGiveUpClick","playSound","SOUND","SELL","addGold","onBtnRefreshClick","CLICK","pay","err","hideDialog","showDialog"],"mappings":"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","sourcesContent":["import { localConfig } from './../../framework/localConfig';\nimport { GameManager } from './../../fight/gameManager';\nimport { SkillItem } from './skillItem';\nimport { util } from './../../framework/util';\nimport { uiManager } from './../../framework/uiManager';\nimport { constant } from './../../framework/constant';\nimport { playerData } from './../../framework/playerData';\n\nimport { _decorator, Component, Node, SpriteComponent, LabelComponent } from 'cc';\nimport { SdkUtil } from '../../framework/sdkUtil';\nimport { AudioManager } from '../../framework/audioManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('SkillPanel')\nexport class SkillPanel extends Component {\n    @property(Node)\n    public ndSkills: Node = null!\n\n    @property(SpriteComponent)\n    public spRefreshIcon: SpriteComponent = null!;\n\n    @property(LabelComponent)\n    public lbGold: LabelComponent = null!;\n\n    private _gold: number = 50;\n    private _callback: Function = null!;\n\n    start () {\n        // [3]\n    }\n\n    public show (callback?: Function) {\n        this._callback = callback!;\n        this.lbGold.string = `获得 ${this._gold}`;\n\n        SdkUtil.updatePayIcon(constant.SHARE_ID.SKILL_REFRESH, this.spRefreshIcon);\n\n        let arrLock: any = playerData.instance.getLockPlyerSkill();\n        arrLock = util.shuffle(arrLock);\n        \n        this.ndSkills.children.forEach((ndChild: Node, idx: number, arr: any)=>{\n            if (arrLock[idx]) {\n                let info: any = localConfig.instance.queryByID(\"playerSkill\", arrLock[idx].ID);\n                ndChild.active = true;\n                let scriptItem = ndChild.getComponent(SkillItem) as SkillItem;\n                scriptItem.init(info, ()=>{\n                    this._close();\n                });\n            } else {\n                ndChild.active = false;\n            }\n        })\n    }\n\n    public onBtnGiveUpClick () {\n        AudioManager.instance.playSound(constant.SOUND.SELL);\n\n        GameManager.addGold(this._gold);\n        this._close();\n    }\n\n    public onBtnRefreshClick () {\n        AudioManager.instance.playSound(constant.SOUND.CLICK);\n\n        SdkUtil.pay(constant.SHARE_ID.SKILL_REFRESH, (err: any)=>{\n            if (!err) {\n                this.show(this._callback);\n            }\n        })\n    }\n\n    private _close () {\n        this._callback && this._callback();\n        uiManager.instance.hideDialog(\"skill/skillPanel\");\n        uiManager.instance.showDialog(\"fight/fightPanel\");\n    }\n\n    // update (deltaTime: number) {\n    //     // [4]\n    // }\n}\n"]}