{"version":3,"sources":["file:///Users/ykq/Downloads/archero/assets/script/fight/warningSkill/warningCircle.ts"],"names":["_decorator","Component","tween","Vec3","GameManager","poolManager","ccclass","property","WarningCircle","start","init","scale","scriptParent","recycleWarning","_scriptParent","_targetScale_1","set","_targetScale_2","node","setScale","_targetScale_3","playerWorPos","ndPlayer","worldPosition","_targetWorPos","x","y","z","setWorldPosition","_closeTween","showWarning","showTime","_tweenLoop","to","easing","hideWarning","_tweenHide","call","instance","putNode","stop"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;;AADpCC,MAAAA,W,iBAAAA,W;;AAEAC,MAAAA,W,iBAAAA,W;;;;;;;AACDC,MAAAA,O,GAAsBN,U,CAAtBM,O;AAASC,MAAAA,Q,GAAaP,U,CAAbO,Q;;+BAGJC,a,WADZF,OAAO,CAAC,eAAD,C;;;;;;;;;;;;uEAEsB,I;;uEACA,I;;0EACI,IAAIH,IAAJ,E;;2EACC,IAAIA,IAAJ,E;;2EACA,IAAIA,IAAJ,E;;2EACA,IAAIA,IAAJ,E;;0EACF,I;;;;;;;eAE7BM,K,GAAA,iBAAS,CACL;AACH,S;;eAEMC,I,GAAP,cAAaC,KAAb,EAA4BC,YAA5B,EAA+C;AAC3CA,UAAAA,YAAY,CAACC,cAAb;AACA,eAAKC,aAAL,GAAqBF,YAArB;;AACA,eAAKG,cAAL,CAAoBC,GAApB,CAAwBL,KAAxB,EAA+BA,KAA/B,EAAsCA,KAAtC;;AACA,eAAKM,cAAL,CAAoBD,GAApB,CAAwBL,KAAK,GAAG,GAAhC,EAAqCA,KAAK,GAAG,GAA7C,EAAkDA,KAAK,GAAG,GAA1D;;AACA,eAAKO,IAAL,CAAUC,QAAV,CAAmB,KAAKC,cAAxB;AAEA,cAAIC,YAAY,GAAG;AAAA;AAAA,0CAAYC,QAAZ,CAAqBC,aAAxC;;AACA,eAAKC,aAAL,CAAmBR,GAAnB,CAAuBK,YAAY,CAACI,CAApC,EAAuCJ,YAAY,CAACK,CAAb,GAAiB,GAAxD,EAA6DL,YAAY,CAACM,CAA1E;;AACA,eAAKT,IAAL,CAAUU,gBAAV,CAA2B,KAAKJ,aAAhC;;AAEA,eAAKK,WAAL;;AACA,eAAKC,WAAL;AACH,S;;eAEMA,W,GAAP,uBAAsB;AAClB,cAAIC,QAAQ,GAAG,GAAf;AAEA,eAAKC,UAAL,GAAkB9B,KAAK,CAAC,KAAKgB,IAAN,CAAL,CACjBe,EADiB,CACdF,QADc,EACJ;AAACpB,YAAAA,KAAK,EAAE,KAAKI;AAAb,WADI,EAC0B;AAACmB,YAAAA,MAAM,EAAE;AAAT,WAD1B,EAEjBzB,KAFiB,EAAlB;AAGH,S;;eAEM0B,W,GAAP,uBAAsB;AAAA;;AAClB,eAAKN,WAAL;;AAEA,eAAKO,UAAL,GAAkBlC,KAAK,CAAC,KAAKgB,IAAN,CAAL,CACjBe,EADiB,CACd,GADc,EACT;AAACtB,YAAAA,KAAK,EAAE,KAAKS;AAAb,WADS,EACqB;AAACc,YAAAA,MAAM,EAAE;AAAT,WADrB,EAEjBG,IAFiB,CAEZ,YAAI;AACN;AAAA;AAAA,4CAAYC,QAAZ,CAAqBC,OAArB,CAA6B,MAAI,CAACrB,IAAlC;;AACA,YAAA,MAAI,CAACW,WAAL;AACH,WALiB,EAMjBpB,KANiB,EAAlB;AAOH,S;;eAEOoB,W,GAAR,uBAAsB;AAClB,cAAI,KAAKO,UAAT,EAAqB;AACjB,iBAAKA,UAAL,CAAgBI,IAAhB;;AACA,iBAAKJ,UAAL,GAAkB,IAAlB;AACH;;AAED,cAAI,KAAKJ,UAAT,EAAqB;AACjB,iBAAKA,UAAL,CAAgBQ,IAAhB;;AACA,iBAAKR,UAAL,GAAkB,IAAlB;AACH;AACJ,S;;;QA1D8B/B,S","sourcesContent":["import { GameManager } from './../gameManager';\nimport { _decorator, Component, Node, tween, Vec3, Color, MeshRenderer, Material } from 'cc';\nimport { poolManager } from '../../framework/poolManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('WarningCircle')\nexport class WarningCircle extends Component {\n    private _tweenLoop: any = null!;//循环缩小放大tween实例\n    private _tweenHide: any = null!;//缩小消失tween实例\n    private _targetWorPos: Vec3 = new Vec3();\n    private _targetScale_1: Vec3 = new Vec3();\n    private _targetScale_2: Vec3 = new Vec3();\n    private _targetScale_3: Vec3 = new Vec3();\n    private _scriptParent: any = null!;\n\n    start () {\n        // [3]\n    }\n\n    public init (scale: number, scriptParent: any) {\n        scriptParent.recycleWarning();\n        this._scriptParent = scriptParent;\n        this._targetScale_1.set(scale, scale, scale);\n        this._targetScale_2.set(scale * 0.8, scale * 0.8, scale * 0.8);\n        this.node.setScale(this._targetScale_3);\n\n        let playerWorPos = GameManager.ndPlayer.worldPosition;\n        this._targetWorPos.set(playerWorPos.x, playerWorPos.y + 0.2, playerWorPos.z);\n        this.node.setWorldPosition(this._targetWorPos);\n        \n        this._closeTween();\n        this.showWarning();\n    }\n\n    public showWarning () {\n        let showTime = 0.4;\n\n        this._tweenLoop = tween(this.node)\n        .to(showTime, {scale: this._targetScale_1}, {easing: \"smooth\"})\n        .start();        \n    }\n\n    public hideWarning () {\n        this._closeTween();\n\n        this._tweenHide = tween(this.node)\n        .to(0.3, {scale: this._targetScale_3}, {easing: \"backInOut\"})\n        .call(()=>{\n            poolManager.instance.putNode(this.node);\n            this._closeTween();\n        })\n        .start();           \n    }\n\n    private _closeTween() {\n        if (this._tweenHide) {\n            this._tweenHide.stop();\n            this._tweenHide = null!;\n        }\n\n        if (this._tweenLoop) {\n            this._tweenLoop.stop();\n            this._tweenLoop = null!;\n        }\n    }\n}"]}