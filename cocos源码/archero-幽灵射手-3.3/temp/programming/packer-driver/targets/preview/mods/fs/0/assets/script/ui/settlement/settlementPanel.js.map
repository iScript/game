{"version":3,"sources":["file:///Users/ykq/Downloads/archero/assets/script/ui/settlement/settlementPanel.ts"],"names":["SpriteComponent","_decorator","Component","Node","SpriteFrame","LabelComponent","constant","playerData","GameManager","uiManager","clientEvent","SkillList","AudioManager","ccclass","property","SettlementPanel","start","show","callback","_callback","lbLevel","string","instance","playerInfo","level","isWin","spTitle","spriteFrame","sfTitleWin","scriptSkillList","ndSkillList","getComponent","init","onBtnHomeClick","playSound","SOUND","CLICK","arrSkill","savePlayerInfoToLocalCache","hideDialog","showDialog","onBtnPlayAgainClick","dispatchEvent","EVENT_TYPE","ON_GAME_INIT"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGSA,MAAAA,e,OAAAA,e;AAGAC,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;AAAoBC,MAAAA,c,OAAAA,c;;AANjDC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,W,iBAAAA,W;;AAEAC,MAAAA,S,iBAAAA,S;;AAGAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;AACDC,MAAAA,O,GAAsBZ,U,CAAtBY,O;AAASC,MAAAA,Q,GAAab,U,CAAba,Q;;iCAGJC,e,WADZF,OAAO,CAAC,iBAAD,C,UAEHC,QAAQ,CAACV,WAAD,C,UAGRU,QAAQ,CAACV,WAAD,C,UAGRU,QAAQ,CAACd,eAAD,C,UAGRc,QAAQ,CAACT,cAAD,C,UAGRS,QAAQ,CAACX,IAAD,C;;;;;;;;;;;;;;;;;;;;;;sEAGqB,I;;;;;;;eAE9Ba,K,GAAA,iBAAS,CACL;AACH,S;;eAEMC,I,GAAP,cAAaC,QAAb,EAAiC;AAC7B,eAAKC,SAAL,GAAiBD,QAAjB;AAEA,eAAKE,OAAL,CAAaC,MAAb,GAAsB;AAAA;AAAA,wCAAWC,QAAX,CAAoBC,UAApB,CAA+BC,KAArD;;AAEA,cAAI;AAAA;AAAA,0CAAYC,KAAhB,EAAuB;AACnB,iBAAKC,OAAL,CAAaC,WAAb,GAA2B,KAAKC,UAAhC;AACH,WAFD,MAEO;AACH,iBAAKF,OAAL,CAAaC,WAAb,GAA2B,KAAKC,UAAhC;AACH;;AAED,cAAIC,eAAe,GAAG,KAAKC,WAAL,CAAiBC,YAAjB;AAAA;AAAA,qCAAtB;AACAF,UAAAA,eAAe,CAACG,IAAhB;AACH,S;;eAEMC,c,GAAP,0BAAyB;AACrB;AAAA;AAAA,4CAAaX,QAAb,CAAsBY,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,KAA/C;AAEA,eAAKjB,SAAL,IAAkB,KAAKA,SAAL,EAAlB;;AAEA,cAAI,CAAC;AAAA;AAAA,0CAAYM,KAAjB,EAAwB;AACpB;AACA;AAAA;AAAA,0CAAWH,QAAX,CAAoBC,UAApB,CAA+Bc,QAA/B,GAA0C,EAA1C;AACA;AAAA;AAAA,0CAAWf,QAAX,CAAoBC,UAApB,CAA+BC,KAA/B,GAAuC,CAAvC;AACA;AAAA;AAAA,0CAAWF,QAAX,CAAoBgB,0BAApB;AACH;;AAED;AAAA;AAAA,sCAAUhB,QAAV,CAAmBiB,UAAnB,CAA8B,4BAA9B;AACA;AAAA;AAAA,sCAAUjB,QAAV,CAAmBkB,UAAnB,CAA8B,gBAA9B;AACH,S;;eAEMC,mB,GAAP,+BAA8B;AAC1B;AAAA;AAAA,4CAAanB,QAAb,CAAsBY,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,KAA/C;AAEA;AAAA;AAAA,sCAAUd,QAAV,CAAmBiB,UAAnB,CAA8B,4BAA9B;AAEA;AAAA;AAAA,sCAAUjB,QAAV,CAAmBkB,UAAnB,CAA8B,kBAA9B;AACA;AAAA;AAAA,0CAAYE,aAAZ,CAA0B;AAAA;AAAA,oCAASC,UAAT,CAAoBC,YAA9C;AACH,S,CAGD;AACA;AACA;;;;QAjEiC1C,S;;;;;iBAEA,I;;;;;;;iBAGC,I;;;;;;;iBAGA,I;;;;;;;iBAGD,I;;;;;;;iBAGN,I;;;AAsD/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["import { constant } from './../../framework/constant';\nimport { playerData } from './../../framework/playerData';\nimport { GameManager } from './../../fight/gameManager';\nimport { SpriteComponent } from 'cc';\nimport { uiManager } from './../../framework/uiManager';\n\nimport { _decorator, Component, Node, SpriteFrame, Label, LabelComponent } from 'cc';\nimport { clientEvent } from '../../framework/clientEvent';\nimport { SkillList } from '../pause/skillList';\nimport { AudioManager } from '../../framework/audioManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('SettlementPanel')\nexport class SettlementPanel extends Component {\n    @property(SpriteFrame)\n    public sfTitleWin: SpriteFrame = null!;\n\n    @property(SpriteFrame)\n    public sfTitleFail: SpriteFrame = null!;\n\n    @property(SpriteComponent)\n    public spTitle: SpriteComponent = null!;\n\n    @property(LabelComponent)\n    public lbLevel: LabelComponent = null!;\n\n    @property(Node)\n    public ndSkillList: Node = null!;\n\n    private _callback: Function = null!;\n\n    start () {\n        // [3]\n    }\n\n    public show (callback: Function) {\n        this._callback = callback;\n\n        this.lbLevel.string = playerData.instance.playerInfo.level;\n\n        if (GameManager.isWin) {\n            this.spTitle.spriteFrame = this.sfTitleWin;\n        } else {\n            this.spTitle.spriteFrame = this.sfTitleWin;\n        }\n\n        let scriptSkillList = this.ndSkillList.getComponent(SkillList) as SkillList;\n        scriptSkillList.init();\n    }\n\n    public onBtnHomeClick () {\n        AudioManager.instance.playSound(constant.SOUND.CLICK);\n\n        this._callback && this._callback();\n\n        if (!GameManager.isWin) {\n            //失败的时候清空技能和层级\n            playerData.instance.playerInfo.arrSkill = [];\n            playerData.instance.playerInfo.level = 1;\n            playerData.instance.savePlayerInfoToLocalCache();\n        }\n\n        uiManager.instance.hideDialog(\"settlement/settlementPanel\");\n        uiManager.instance.showDialog(\"home/homePanel\");\n    }\n\n    public onBtnPlayAgainClick () {\n        AudioManager.instance.playSound(constant.SOUND.CLICK);\n\n        uiManager.instance.hideDialog(\"settlement/settlementPanel\");\n\n        uiManager.instance.showDialog(\"fight/fightPanel\");\n        clientEvent.dispatchEvent(constant.EVENT_TYPE.ON_GAME_INIT);\n    }\n\n\n    // update (deltaTime: number) {\n    //     // [4]\n    // }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.0/manual/en/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.0/manual/en/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.0/manual/en/scripting/life-cycle-callbacks.html\n */\n"]}