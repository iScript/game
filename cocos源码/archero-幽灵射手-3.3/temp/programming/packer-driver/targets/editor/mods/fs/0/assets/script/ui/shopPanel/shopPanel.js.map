{"version":3,"sources":["file:///Users/ykq/Downloads/archero/assets/script/ui/shopPanel/shopPanel.ts"],"names":["_decorator","Component","Node","SpriteComponent","ShopItem","util","uiManager","constant","playerData","SdkUtil","localConfig","AudioManager","ccclass","property","ShopPanel","start","show","callback","_callback","updatePayIcon","SHARE_ID","SHOP_REFRESH","spRefreshIcon","arrLock","instance","getLockPlyerSkill","shuffle","ndSkills","children","forEach","ndChild","idx","arr","info","queryByID","ID","active","scriptItem","getComponent","init","_close","onBtnGiveUpClick","playSound","SOUND","CLICK","onBtnRefreshClick","pay","err","hideDialog","showDialog","onBtnCloseClick"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,e,OAAAA,e;;AAL7BC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,U,iBAAAA,U;;AAEAC,MAAAA,O,iBAAAA,O;;AACAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBb,U;;2BAGjBc,S,WADZF,OAAO,CAAC,WAAD,C,UAEHC,QAAQ,CAACX,IAAD,C,UAGRW,QAAQ,CAACV,eAAD,C,oCALb,MACaW,SADb,SAC+Bb,SAD/B,CACyC;AAAA;AAAA;;AAAA;;AAAA;;AAAA,6CAOP,IAPO;AAAA;;AASrCc,QAAAA,KAAK,GAAI,CACL;AACH;;AAEMC,QAAAA,IAAI,CAAEC,QAAF,EAAuB;AAC9B,eAAKC,SAAL,GAAiBD,QAAjB;AACA;AAAA;AAAA,kCAAQE,aAAR,CAAsB;AAAA;AAAA,oCAASC,QAAT,CAAkBC,YAAxC,EAAsD,KAAKC,aAA3D;AAEA,cAAIC,OAAY,GAAG;AAAA;AAAA,wCAAWC,QAAX,CAAoBC,iBAApB,EAAnB;AACAF,UAAAA,OAAO,GAAG;AAAA;AAAA,4BAAKG,OAAL,CAAaH,OAAb,CAAV;AAEA,eAAKI,QAAL,CAAcC,QAAd,CAAuBC,OAAvB,CAA+B,CAACC,OAAD,EAAgBC,GAAhB,EAA6BC,GAA7B,KAAwC;AACnE,gBAAIT,OAAO,CAACQ,GAAD,CAAX,EAAkB;AACd,kBAAIE,IAAS,GAAG;AAAA;AAAA,8CAAYT,QAAZ,CAAqBU,SAArB,CAA+B,aAA/B,EAA8CX,OAAO,CAACQ,GAAD,CAAP,CAAaI,EAA3D,CAAhB;AACAL,cAAAA,OAAO,CAACM,MAAR,GAAiB,IAAjB;AACA,kBAAIC,UAAU,GAAGP,OAAO,CAACQ,YAAR;AAAA;AAAA,uCAAjB;AACAD,cAAAA,UAAU,CAACE,IAAX,CAAgBN,IAAhB,EAAsB,MAAI;AACtB,qBAAKO,MAAL;AACH,eAFD;AAGH,aAPD,MAOO;AACHV,cAAAA,OAAO,CAACM,MAAR,GAAiB,KAAjB;AACH;AACJ,WAXD;AAYH;;AAEMK,QAAAA,gBAAgB,GAAI;AACvB;AAAA;AAAA,4CAAajB,QAAb,CAAsBkB,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,KAA/C;;AAEA,eAAKJ,MAAL;AACH;;AAEMK,QAAAA,iBAAiB,GAAI;AACxB;AAAA;AAAA,4CAAarB,QAAb,CAAsBkB,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,KAA/C;AAEA;AAAA;AAAA,kCAAQE,GAAR,CAAY;AAAA;AAAA,oCAAS1B,QAAT,CAAkBC,YAA9B,EAA6C0B,GAAD,IAAY;AACpD,gBAAI,CAACA,GAAL,EAAU;AACN,mBAAK/B,IAAL,CAAU,KAAKE,SAAf;AACH;AACJ,WAJD;AAKH;;AAEOsB,QAAAA,MAAM,GAAI;AACd,eAAKtB,SAAL,IAAkB,KAAKA,SAAL,EAAlB;AACA;AAAA;AAAA,sCAAUM,QAAV,CAAmBwB,UAAnB,CAA8B,gBAA9B;AACA;AAAA;AAAA,sCAAUxB,QAAV,CAAmByB,UAAnB,CAA8B,kBAA9B;AACH;;AAEMC,QAAAA,eAAe,GAAI;AACtB;AAAA;AAAA,4CAAa1B,QAAb,CAAsBkB,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,KAA/C;;AAEA,eAAKJ,MAAL;AACH,SA5DoC,CA8DrC;AACA;AACA;;;AAhEqC,O;;;;;iBAEb,I;;;;;;;iBAGgB,I","sourcesContent":["import { ShopItem } from './shopItem';\nimport { util } from './../../framework/util';\nimport { uiManager } from './../../framework/uiManager';\nimport { constant } from './../../framework/constant';\nimport { playerData } from './../../framework/playerData';\nimport { _decorator, Component, Node, SpriteComponent, LabelComponent } from 'cc';\nimport { SdkUtil } from '../../framework/sdkUtil';\nimport { localConfig } from '../../framework/localConfig';\nimport { AudioManager } from '../../framework/audioManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('ShopPanel')\nexport class ShopPanel extends Component {\n    @property(Node)\n    public ndSkills: Node = null!;\n\n    @property(SpriteComponent)\n    public spRefreshIcon: SpriteComponent = null!;\n\n    private _callback: Function = null!;\n\n    start () {\n        // [3]\n    }\n\n    public show (callback?: Function) {\n        this._callback = callback!;\n        SdkUtil.updatePayIcon(constant.SHARE_ID.SHOP_REFRESH, this.spRefreshIcon);\n\n        let arrLock: any = playerData.instance.getLockPlyerSkill();\n        arrLock = util.shuffle(arrLock);\n        \n        this.ndSkills.children.forEach((ndChild: Node, idx: number, arr: any)=>{\n            if (arrLock[idx]) {\n                let info: any = localConfig.instance.queryByID(\"playerSkill\", arrLock[idx].ID);\n                ndChild.active = true;\n                let scriptItem = ndChild.getComponent(ShopItem) as ShopItem;\n                scriptItem.init(info, ()=>{\n                    this._close();\n                });\n            } else {\n                ndChild.active = false;\n            }\n        })\n    }\n\n    public onBtnGiveUpClick () {\n        AudioManager.instance.playSound(constant.SOUND.CLICK);\n\n        this._close();\n    }\n\n    public onBtnRefreshClick () {\n        AudioManager.instance.playSound(constant.SOUND.CLICK);\n\n        SdkUtil.pay(constant.SHARE_ID.SHOP_REFRESH, (err: any)=>{\n            if (!err) {\n                this.show(this._callback);\n            }\n        })\n    }\n\n    private _close () {\n        this._callback && this._callback();\n        uiManager.instance.hideDialog(\"shop/shopPanel\");\n        uiManager.instance.showDialog(\"fight/fightPanel\");\n    }\n\n    public onBtnCloseClick () {\n        AudioManager.instance.playSound(constant.SOUND.CLICK);\n\n        this._close();\n    }\n\n    // update (deltaTime: number) {\n    //     // [4]\n    // }\n}\n"]}