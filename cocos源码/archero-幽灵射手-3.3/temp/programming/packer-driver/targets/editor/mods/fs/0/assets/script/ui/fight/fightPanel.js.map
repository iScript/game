{"version":3,"sources":["file:///Users/ykq/Downloads/archero/assets/script/ui/fight/fightPanel.ts"],"names":["_decorator","Component","Node","LabelComponent","uiManager","BossBloodBar","GameManager","util","playerData","constant","clientEvent","localConfig","AudioManager","ccclass","property","FightPanel","onEnable","on","EVENT_TYPE","REFRESH_GOLD","_refreshGold","REFRESH_LEVEL","_refreshLevel","onDisable","off","start","show","ndBossBloodBar","active","ndBoss","bossInfo","instance","queryByID","BASE","BOSS_01","scriptBossBloodBar","getComponent","scriptBoss","hp","_debugClickTimes","lbGold","string","formatMoney","playerInfo","gold","lbLevel","level","onBtnPauseClick","playSound","SOUND","CLICK","showDialog","PRIORITY","DIALOG","isGamePause","onBtnDebugClick"],"mappings":"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","sourcesContent":["import { uiManager } from './../../framework/uiManager';\nimport { BossBloodBar } from './bossBloodBar';\nimport { GameManager } from './../../fight/gameManager';\nimport { util } from './../../framework/util';\nimport { playerData } from './../../framework/playerData';\nimport { constant } from './../../framework/constant';\nimport { clientEvent } from './../../framework/clientEvent';\nimport { _decorator, Component, Node, LabelComponent, Label, ProgressBar, UITransform, profiler } from 'cc';\nimport { localConfig } from '../../framework/localConfig';\nimport { AudioManager } from '../../framework/audioManager';\nconst { ccclass, property } = _decorator;\n\n@ccclass('FightPanel')\nexport class FightPanel extends Component {\n    @property(Node)\n    public ndJoystick: Node = null!;//手柄节点\n\n    @property(LabelComponent)\n    public lbGold: LabelComponent = null!;//金币数量\n\n    @property(LabelComponent)\n    public lbLevel: LabelComponent = null!;//等级\n\n    @property(Node)\n    public ndBossBloodBar: Node = null!;//boss血量进度条节点\n\n    private _debugClickTimes: number = 0;//调试点击次数\n\n    onEnable () {\n        clientEvent.on(constant.EVENT_TYPE.REFRESH_GOLD, this._refreshGold, this);\n        clientEvent.on(constant.EVENT_TYPE.REFRESH_LEVEL, this._refreshLevel, this);\n    }\n\n    onDisable () {\n        clientEvent.off(constant.EVENT_TYPE.REFRESH_GOLD, this._refreshGold, this);\n        clientEvent.off(constant.EVENT_TYPE.REFRESH_LEVEL, this._refreshLevel, this);\n    }\n\n    start () {\n        // [3]\n    }\n\n    show () {\n        this.ndBossBloodBar.active = false;\n\n        this._refreshGold();\n        this._refreshLevel();\n\n        if (GameManager.ndBoss) {\n            let bossInfo = localConfig.instance.queryByID(\"base\", constant.BASE.BOSS_01);\n            let scriptBossBloodBar = this.ndBossBloodBar.getComponent(BossBloodBar) as BossBloodBar;\n            scriptBossBloodBar.show(GameManager.scriptBoss, bossInfo.hp);\n        }\n\n        this._debugClickTimes = 0;\n    }\n\n    private _refreshGold () {\n        this.lbGold.string = util.formatMoney(playerData.instance.playerInfo.gold);\n    }\n\n    private _refreshLevel () {\n        this.lbLevel.string = `第${playerData.instance.playerInfo.level}层`;\n    }\n\n    public onBtnPauseClick () {\n        AudioManager.instance.playSound(constant.SOUND.CLICK);\n\n        uiManager.instance.showDialog(\"pause/pausePanel\", [], ()=>{}, constant.PRIORITY.DIALOG);\n        GameManager.isGamePause = true;\n    }\n\n    public onBtnDebugClick () {\n        AudioManager.instance.playSound(constant.SOUND.CLICK);\n\n        this._debugClickTimes += 1;\n\n        if (this._debugClickTimes >= 1) {\n            this._debugClickTimes = 0;\n            uiManager.instance.showDialog(\"debug/debugPanel\", [], ()=>{}, constant.PRIORITY.DIALOG);\n        }\n    }\n}\n"]}