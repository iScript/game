{"version":3,"sources":["file:///Users/ykq/Downloads/archero/assets/script/fight/monsterSkill/energyBall.ts"],"names":["_decorator","Component","Node","Vec3","util","GameManager","poolManager","EffectManager","AudioManager","constant","ccclass","property","EnergyBall","start","init","skillInfo","baseInfo","scriptParent","scriptWarning","hideWarning","_targetSpeed","flySpeed","_curSpeed","instance","playTrail","node","playSound","SOUND","ENERGY_BALL","update","deltaTime","parent","ndPlayer","isGameOver","isGamePause","lerp","_targetWorPos","set","translate","NodeSpace","LOCAL","_curWorPos","worldPosition","subtract","_offsetPos","length","_disappearRange","putNode"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAESA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;AAF7BC,MAAAA,I,iBAAAA,I;;AACAC,MAAAA,W,iBAAAA,W;;AAEAC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;AACT;OACM;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBX,U;;4BAGjBY,U,WADZF,OAAO,CAAC,YAAD,C,yBAAR,MACaE,UADb,SACgCX,SADhC,CAC0C;AAAA;AAAA;;AAAA,4CACf,IADe;;AAAA,6CAEd,IAFc;;AAAA,6CAIV,CAJU;;AAAA,gDAKP,CALO;;AAAA,8CAMX,IAAIE,IAAJ,EANW;;AAAA,8CAOX,IAAIA,IAAJ,EAPW;;AAAA,mDAQJ,EARI;;AAAA,iDASR,IAAIA,IAAJ,EATQ;AAAA;;AASG;AAEzCU,QAAAA,KAAK,GAAI,CACL;AACH;AAED;AACJ;AACA;;;AACWC,QAAAA,IAAI,CAAEC,SAAF,EAAkBC,QAAlB,EAAiCC,YAAjC,EAAoD;AAAA;;AAC3D,eAAKF,SAAL,GAAiBA,SAAjB;AACA,eAAKC,QAAL,GAAgBA,QAAhB;AACA,mCAAAC,YAAY,CAACC,aAAb,gFAA4BC,WAA5B;AACA,eAAKC,YAAL,GAAoBL,SAAS,CAACM,QAA9B;AAAuC;AACvC,eAAKC,SAAL,GAAiBP,SAAS,CAACM,QAAV,GAAqB,GAAtC;AAEA;AAAA;AAAA,8CAAcE,QAAd,CAAuBC,SAAvB,CAAiC,KAAKC,IAAtC;AAEA;AAAA;AAAA,4CAAaF,QAAb,CAAsBG,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,WAA/C;AACH;;AAEDC,QAAAA,MAAM,CAAEC,SAAF,EAAqB;AACvB,cAAI,CAAC,KAAKL,IAAL,CAAUM,MAAX,IAAqB,CAAC;AAAA;AAAA,0CAAYC,QAAlC,IAA8C;AAAA;AAAA,0CAAYC,UAA1D,IAAwE;AAAA;AAAA,0CAAYC,WAAxF,EAAqG;AACjG;AACH,WAHsB,CAKvB;;;AACA,eAAKZ,SAAL,GAAiB;AAAA;AAAA,4BAAKa,IAAL,CAAU,KAAKf,YAAf,EAA6B,KAAKE,SAAlC,EAA6C,IAA7C,CAAjB;;AACA,eAAKc,aAAL,CAAmBC,GAAnB,CAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAACP,SAAD,GAAa,KAAKR,SAA/C;;AACA,eAAKG,IAAL,CAAUa,SAAV,CAAoB,KAAKF,aAAzB,EAAwClC,IAAI,CAACqC,SAAL,CAAeC,KAAvD;;AACA,eAAKC,UAAL,CAAgBJ,GAAhB,CAAoB,KAAKZ,IAAL,CAAUiB,aAA9B,EATuB,CAWvB;;;AACAvC,UAAAA,IAAI,CAACwC,QAAL,CAAc,KAAKC,UAAnB,EAA+B,KAAKH,UAApC,EAAgD;AAAA;AAAA,0CAAYT,QAAZ,CAAqBU,aAArE;;AACA,cAAI,KAAKE,UAAL,IAAmB,KAAKA,UAAL,CAAgBC,MAAhB,MAA4B,KAAKC,eAAxD,EAAyE;AACrE;AAAA;AAAA,4CAAYvB,QAAZ,CAAqBwB,OAArB,CAA6B,KAAKtB,IAAlC;AACH;AACJ;;AA9CqC,O","sourcesContent":["import { util } from './../../framework/util';\nimport { GameManager } from './../gameManager';\nimport { _decorator, Component, Node, Vec3 } from 'cc';\nimport { poolManager } from '../../framework/poolManager';\nimport { EffectManager } from '../../framework/effectManager';\nimport { AudioManager } from '../../framework/audioManager';\nimport { constant } from '../../framework/constant';\n//能量球组件: 直线飞行\nconst { ccclass, property } = _decorator;\n\n@ccclass('EnergyBall')\nexport class EnergyBall extends Component {\n    public baseInfo: any = null!;//敌人基本信息\n    public skillInfo: any = null!;//技能信息\n\n    private _curSpeed: number = 0;//当前速度\n    private _targetSpeed: number = 0;//目标速度\n    private _offsetPos: Vec3 = new Vec3();//和玩家之间的向量差\n    private _curWorPos: Vec3 = new Vec3();//当前节点世界坐标\n    private _disappearRange: number = 25;//能量球节点超过玩家这个范围则隐藏\n    private _targetWorPos: Vec3 = new Vec3();//能量球的下次目标位置\n\n    start () {\n        // [3]\n    }\n\n    /**\n    * 初始化 \n    */\n    public init (skillInfo: any, baseInfo: any, scriptParent: any) {\n        this.skillInfo = skillInfo;\n        this.baseInfo = baseInfo;\n        scriptParent.scriptWarning?.hideWarning();\n        this._targetSpeed = skillInfo.flySpeed;;\n        this._curSpeed = skillInfo.flySpeed * 0.5;\n\n        EffectManager.instance.playTrail(this.node);\n\n        AudioManager.instance.playSound(constant.SOUND.ENERGY_BALL);  \n    }\n\n    update (deltaTime: number) {\n        if (!this.node.parent || !GameManager.ndPlayer || GameManager.isGameOver || GameManager.isGamePause) {\n            return;\n        }\n\n        //朝forward方向飞行\n        this._curSpeed = util.lerp(this._targetSpeed, this._curSpeed, 0.25);\n        this._targetWorPos.set(0, 0, -deltaTime * this._curSpeed);\n        this.node.translate(this._targetWorPos, Node.NodeSpace.LOCAL);\n        this._curWorPos.set(this.node.worldPosition);\n\n        //超过玩家一定范围则隐藏\n        Vec3.subtract(this._offsetPos, this._curWorPos, GameManager.ndPlayer.worldPosition);\n        if (this._offsetPos && this._offsetPos.length() >= this._disappearRange) {\n            poolManager.instance.putNode(this.node);\n        }\n    }\n}"]}