{"version":3,"sources":["file:///Users/ykq/Downloads/archero/assets/script/ui/shopPanel/shopItem.ts"],"names":["_decorator","Component","SpriteComponent","LabelComponent","Color","ButtonComponent","EffectManager","GameManager","playerData","resourceUtil","AudioManager","constant","ccclass","property","ShopItem","start","init","itemInfo","callback","_itemInfo","_callback","lbName","string","name","lbDesc","desc","lbGold","price","_isMoneyEnough","instance","playerInfo","gold","btnCom","interactable","color","_colorRed","_colorBlack","setSpriteFrame","icon","spSkillIcon","err","onBtnItemClick","playSound","SOUND","SELL","addPlayerSkill","addGold","playEffect","ndPlayer"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,e,OAAAA,e;AAAiBC,MAAAA,c,OAAAA,c;AAAgBC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,e,OAAAA,e;;AAHrEC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,W,iBAAAA,W;;AAGAC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBb,U;;0BAGjBc,Q,WADZF,OAAO,CAAC,UAAD,C,UAEHC,QAAQ,CAACX,eAAD,C,UAGRW,QAAQ,CAACV,cAAD,C,UAGRU,QAAQ,CAACV,cAAD,C,UAGRU,QAAQ,CAACV,cAAD,C,UAGRU,QAAQ,CAACR,eAAD,C,oCAdb,MACaS,QADb,SAC8Bb,SAD9B,CACwC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,6CAgBN,IAhBM;;AAAA,6CAiBX,IAjBW;;AAAA,6CAkBT,IAAIG,KAAJ,CAAU,GAAV,EAAe,CAAf,EAAkB,CAAlB,EAAqB,GAArB,CAlBS;;AAAA,+CAmBP,IAAIA,KAAJ,CAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,GAAnB,CAnBO;;AAAA,kDAoBF,KApBE;AAAA;;AAoBI;AAExCW,QAAAA,KAAK,GAAI,CACL;AACH;;AAEMC,QAAAA,IAAI,CAAEC,QAAF,EAAiBC,QAAjB,EAAqC;AAC5C,eAAKC,SAAL,GAAiBF,QAAjB;AACA,eAAKG,SAAL,GAAiBF,QAAjB;AAEA,eAAKG,MAAL,CAAYC,MAAZ,GAAqBL,QAAQ,CAACM,IAA9B;AACA,eAAKC,MAAL,CAAYF,MAAZ,GAAqBL,QAAQ,CAACQ,IAA9B;AACA,eAAKC,MAAL,CAAYJ,MAAZ,GAAqBL,QAAQ,CAACU,KAA9B;AAEA,eAAKC,cAAL,GAAsB;AAAA;AAAA,wCAAWC,QAAX,CAAoBC,UAApB,CAA+BC,IAA/B,IAAuCd,QAAQ,CAACU,KAAtE;AACA,eAAKK,MAAL,CAAYC,YAAZ,GAA2B,KAAKL,cAAhC;;AAEA,cAAI,CAAC,KAAKA,cAAV,EAA0B;AACtB,iBAAKF,MAAL,CAAYQ,KAAZ,GAAoB,KAAKC,SAAzB;AACH,WAFD,MAEO;AACH,iBAAKT,MAAL,CAAYQ,KAAZ,GAAoB,KAAKE,WAAzB;AACH;;AAED;AAAA;AAAA,4CAAaC,cAAb,CAA6B,qBAAoBpB,QAAQ,CAACqB,IAAK,EAA/D,EAAkE,KAAKC,WAAvE,EAAqFC,GAAD,IAAY,CAAE,CAAlG;AACH;;AAEMC,QAAAA,cAAc,GAAI;AACrB;AAAA;AAAA,4CAAaZ,QAAb,CAAsBa,SAAtB,CAAgC;AAAA;AAAA,oCAASC,KAAT,CAAeC,IAA/C;;AAEA,cAAI,KAAKhB,cAAT,EAAyB;AACrB,iBAAKR,SAAL,IAAkB,KAAKA,SAAL,EAAlB;AACA;AAAA;AAAA,0CAAWS,QAAX,CAAoBgB,cAApB,CAAmC,KAAK1B,SAAxC;AACA;AAAA;AAAA,4CAAY2B,OAAZ,CAAoB,CAAC,KAAK3B,SAAL,CAAeQ,KAApC;AAEA;AAAA;AAAA,gDAAcE,QAAd,CAAuBkB,UAAvB,CAAkC;AAAA;AAAA,4CAAYC,QAA9C,EAAwD,iBAAxD;AACH;AACJ;;AAxDmC,O;;;;;iBAEE,I;;;;;;;iBAGN,I;;;;;;;iBAGA,I;;;;;;;iBAGA,I;;;;;;;iBAGC,I","sourcesContent":["import { EffectManager } from './../../framework/effectManager';\nimport { GameManager } from './../../fight/gameManager';\n\nimport { _decorator, Component, Node, SpriteComponent, LabelComponent, Color, ButtonComponent } from 'cc';\nimport { playerData } from '../../framework/playerData';\nimport { resourceUtil } from '../../framework/resourceUtil';\nimport { AudioManager } from '../../framework/audioManager';\nimport { constant } from '../../framework/constant';\nconst { ccclass, property } = _decorator;\n\n@ccclass('ShopItem')\nexport class ShopItem extends Component {\n    @property(SpriteComponent)\n    public spSkillIcon: SpriteComponent = null!;\n    \n    @property(LabelComponent)\n    public lbName: LabelComponent = null!;\n\n    @property(LabelComponent)\n    public lbDesc: LabelComponent = null!;\n\n    @property(LabelComponent)\n    public lbGold: LabelComponent = null!;\n\n    @property(ButtonComponent)\n    public btnCom: ButtonComponent = null!;\n\n    private _callback: Function = null!;\n    private _itemInfo: any = null!;\n    private _colorRed: Color = new Color(255, 0, 0, 255);\n    private _colorBlack: Color = new Color(0, 0, 0, 255);\n    private _isMoneyEnough: boolean = false;//是否有足够的钱购买技能 \n\n    start () {\n        // [3]\n    }\n\n    public init (itemInfo: any, callback: Function) {\n        this._itemInfo = itemInfo;\n        this._callback = callback;\n\n        this.lbName.string = itemInfo.name;\n        this.lbDesc.string = itemInfo.desc;\n        this.lbGold.string = itemInfo.price;\n        \n        this._isMoneyEnough = playerData.instance.playerInfo.gold >= itemInfo.price;\n        this.btnCom.interactable = this._isMoneyEnough;\n\n        if (!this._isMoneyEnough) {\n            this.lbGold.color = this._colorRed; \n        } else {\n            this.lbGold.color = this._colorBlack;\n        }\n\n        resourceUtil.setSpriteFrame(`texture/skillIcon/${itemInfo.icon}`, this.spSkillIcon, (err: any)=>{});\n    }\n\n    public onBtnItemClick () {\n        AudioManager.instance.playSound(constant.SOUND.SELL);\n\n        if (this._isMoneyEnough) {\n            this._callback && this._callback();\n            playerData.instance.addPlayerSkill(this._itemInfo);\n            GameManager.addGold(-this._itemInfo.price);\n\n            EffectManager.instance.playEffect(GameManager.ndPlayer, \"levelUp/levelUp\");\n        }\n    }\n}\n"]}